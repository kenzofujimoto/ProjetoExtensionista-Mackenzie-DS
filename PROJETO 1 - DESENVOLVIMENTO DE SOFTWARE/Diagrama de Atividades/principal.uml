@startuml
title Diagrama de Atividades - Sistema Farmacêutico

start
partition Vendas {
  :Receber pedido de venda;

  if (Estoque disponível?) then (sim)
    :Reservar estoque;
    :Gerar ordem de produção;
  else (não)
    :Notificar PCP;
    :Solicitar compra MP;
    stop
  endif
  :Gerente autoriza produção;
}

partition Produção {
  :Registrar lote;
  :Iniciar produção;
  
  while (Em produção?) is (sim)
    :Monitorar parâmetros;
    if (Ocorrência?) then (sim)
      :Registrar ocorrência;
      if (Crítica?) then (sim)
        :Parar produção;
        stop
      else (não)
        :Ajustar processo;
      endif
    else (não)
      :Continuar produção;
    endif
  endwhile
  
  :Finalizar produção;
}

partition Controle Qualidade {
  :Realizar testes qualidade;
  if (Aprovado?) then (sim)
    :Liberar para estoque;
  else (não)
    if (Pode reprocessar?) then (sim)
      :Encaminhar para reprocesso;
      detach
    else (não)
      :Destinar para descarte;
      stop
    endif
  endif
}

partition Estoque {
  :Atualizar estoque PF;
  :Armazenar produto;
  :Emitir etiqueta RFID;
}

:Notificar venda sobre disponibilidade;

stop

@enduml